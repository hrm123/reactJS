import axios from 'axios';
import MockAdapter from 'axios-mock-adapter';

const API_KEY_OPENWEATHERMAP_ORG='471bd59a5dcdc25cee7484205138f518';
const ROOT_URL = `http://api.openweathermap.org/data/2.5/forecast?appid=${API_KEY_OPENWEATHERMAP_ORG}`;

export const FETCH_WEATHER = 'FETCH_WEATHER';

const mock = new MockAdapter(axios, { delayResponse: 2000 } );
 
// Mock any GET request to /users 
// arguments for reply are (status, data, headers) 
// Expected order of requests:
const mockResponses = [
  ['GET',  ROOT_URL, 200, {"city":{"id":5128581,"name":"New York","coord":{"lon":-74.005966,"lat":40.714272},"country":"US","population":0,"sys":{"population":0}},"cod":"200","message":0.1881,"cnt":35,"list":[{"dt":1481382000,"main":{"temp":271.74,"temp_min":271.74,"temp_max":273.118,"pressure":1039.06,"sea_level":1042.57,"grnd_level":1039.06,"humidity":100,"temp_kf":-1.38},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":{"all":32},"wind":{"speed":2.81,"deg":278.501},"sys":{"pod":"d"},"dt_txt":"2016-12-10 15:00:00"},{"dt":1481392800,"main":{"temp":273.58,"temp_min":273.58,"temp_max":274.505,"pressure":1037.46,"sea_level":1041.06,"grnd_level":1037.46,"humidity":96,"temp_kf":-0.92},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":{"all":48},"wind":{"speed":2.31,"deg":278.501},"sys":{"pod":"d"},"dt_txt":"2016-12-10 18:00:00"},{"dt":1481403600,"main":{"temp":273.87,"temp_min":273.87,"temp_max":274.331,"pressure":1037.51,"sea_level":1041.07,"grnd_level":1037.51,"humidity":97,"temp_kf":-0.46},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"02d"}],"clouds":{"all":8},"wind":{"speed":2.07,"deg":263},"sys":{"pod":"d"},"dt_txt":"2016-12-10 21:00:00"},{"dt":1481414400,"main":{"temp":272.607,"temp_min":272.607,"temp_max":272.607,"pressure":1038.77,"sea_level":1042.46,"grnd_level":1038.77,"humidity":100,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13n"}],"clouds":{"all":56},"wind":{"speed":1.91,"deg":278},"snow":{"3h":0.0675},"sys":{"pod":"n"},"dt_txt":"2016-12-11 00:00:00"},{"dt":1481425200,"main":{"temp":270.857,"temp_min":270.857,"temp_max":270.857,"pressure":1039.14,"sea_level":1042.89,"grnd_level":1039.14,"humidity":100,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.11,"deg":264.506},"snow":{"3h":0.0025},"sys":{"pod":"n"},"dt_txt":"2016-12-11 03:00:00"},{"dt":1481436000,"main":{"temp":270.258,"temp_min":270.258,"temp_max":270.258,"pressure":1039.96,"sea_level":1043.7,"grnd_level":1039.96,"humidity":100,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.57,"deg":288.001},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-11 06:00:00"},{"dt":1481446800,"main":{"temp":269.656,"temp_min":269.656,"temp_max":269.656,"pressure":1040.61,"sea_level":1044.35,"grnd_level":1040.61,"humidity":100,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":32},"wind":{"speed":2.62,"deg":299.513},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-11 09:00:00"},{"dt":1481457600,"main":{"temp":269.542,"temp_min":269.542,"temp_max":269.542,"pressure":1041.78,"sea_level":1045.51,"grnd_level":1041.78,"humidity":100,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":44},"wind":{"speed":2.32,"deg":283.507},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-11 12:00:00"},{"dt":1481468400,"main":{"temp":272.97,"temp_min":272.97,"temp_max":272.97,"pressure":1042.59,"sea_level":1046.16,"grnd_level":1042.59,"humidity":100,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"clouds":{"all":12},"wind":{"speed":1.79,"deg":269.506},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-11 15:00:00"},{"dt":1481479200,"main":{"temp":274.425,"temp_min":274.425,"temp_max":274.425,"pressure":1040.74,"sea_level":1044.27,"grnd_level":1040.74,"humidity":97,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":64},"wind":{"speed":1.79,"deg":227.5},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-11 18:00:00"},{"dt":1481490000,"main":{"temp":274.019,"temp_min":274.019,"temp_max":274.019,"pressure":1040.05,"sea_level":1043.58,"grnd_level":1040.05,"humidity":97,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":56},"wind":{"speed":2.14,"deg":218.501},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-11 21:00:00"},{"dt":1481500800,"main":{"temp":272.649,"temp_min":272.649,"temp_max":272.649,"pressure":1038.89,"sea_level":1042.55,"grnd_level":1038.89,"humidity":100,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04n"}],"clouds":{"all":76},"wind":{"speed":2.81,"deg":220},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-12 00:00:00"},{"dt":1481511600,"main":{"temp":272.812,"temp_min":272.812,"temp_max":272.812,"pressure":1038.05,"sea_level":1041.67,"grnd_level":1038.05,"humidity":100,"temp_kf":0},"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13n"}],"clouds":{"all":92},"wind":{"speed":3.11,"deg":231.5},"snow":{"3h":0.33},"sys":{"pod":"n"},"dt_txt":"2016-12-12 03:00:00"},{"dt":1481522400,"main":{"temp":272.968,"temp_min":272.968,"temp_max":272.968,"pressure":1035.91,"sea_level":1039.46,"grnd_level":1035.91,"humidity":100,"temp_kf":0},"weather":[{"id":601,"main":"Snow","description":"snow","icon":"13n"}],"clouds":{"all":92},"wind":{"speed":2.41,"deg":213.006},"snow":{"3h":1.815},"sys":{"pod":"n"},"dt_txt":"2016-12-12 06:00:00"},{"dt":1481533200,"main":{"temp":273.931,"temp_min":273.931,"temp_max":273.931,"pressure":1032.06,"sea_level":1035.67,"grnd_level":1032.06,"humidity":100,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":92},"wind":{"speed":2.07,"deg":197.5},"rain":{"3h":0.06},"snow":{"3h":3.6},"sys":{"pod":"n"},"dt_txt":"2016-12-12 09:00:00"},{"dt":1481544000,"main":{"temp":274.613,"temp_min":274.613,"temp_max":274.613,"pressure":1029.3,"sea_level":1032.9,"grnd_level":1029.3,"humidity":100,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":92},"wind":{"speed":2.42,"deg":192.501},"rain":{"3h":0.3},"snow":{"3h":5.205},"sys":{"pod":"n"},"dt_txt":"2016-12-12 12:00:00"},{"dt":1481554800,"main":{"temp":275.299,"temp_min":275.299,"temp_max":275.299,"pressure":1026.68,"sea_level":1030.26,"grnd_level":1026.68,"humidity":100,"temp_kf":0},"weather":[{"id":501,"main":"Rain","description":"moderate rain","icon":"10d"}],"clouds":{"all":92},"wind":{"speed":1.31,"deg":229.5},"rain":{"3h":3.14},"snow":{"3h":1.505},"sys":{"pod":"d"},"dt_txt":"2016-12-12 15:00:00"},{"dt":1481565600,"main":{"temp":275.473,"temp_min":275.473,"temp_max":275.473,"pressure":1023.03,"sea_level":1026.54,"grnd_level":1023.03,"humidity":100,"temp_kf":0},"weather":[{"id":501,"main":"Rain","description":"moderate rain","icon":"10d"}],"clouds":{"all":92},"wind":{"speed":0.86,"deg":342.002},"rain":{"3h":3.53},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-12 18:00:00"},{"dt":1481576400,"main":{"temp":275.483,"temp_min":275.483,"temp_max":275.483,"pressure":1020.47,"sea_level":1024.03,"grnd_level":1020.47,"humidity":100,"temp_kf":0},"weather":[{"id":501,"main":"Rain","description":"moderate rain","icon":"10d"}],"clouds":{"all":92},"wind":{"speed":1.27,"deg":85.0048},"rain":{"3h":3.64},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-12 21:00:00"},{"dt":1481587200,"main":{"temp":276.078,"temp_min":276.078,"temp_max":276.078,"pressure":1018.49,"sea_level":1022.16,"grnd_level":1018.49,"humidity":100,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":92},"wind":{"speed":1.36,"deg":155.504},"rain":{"3h":0.16},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-13 00:00:00"},{"dt":1481598000,"main":{"temp":277.477,"temp_min":277.477,"temp_max":277.477,"pressure":1019.05,"sea_level":1022.46,"grnd_level":1019.05,"humidity":100,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":68},"wind":{"speed":3.85,"deg":264.501},"rain":{"3h":0.17},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-13 03:00:00"},{"dt":1481608800,"main":{"temp":278.049,"temp_min":278.049,"temp_max":278.049,"pressure":1020.47,"sea_level":1023.87,"grnd_level":1020.47,"humidity":100,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02n"}],"clouds":{"all":24},"wind":{"speed":5.71,"deg":266.003},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-13 06:00:00"},{"dt":1481619600,"main":{"temp":276.671,"temp_min":276.671,"temp_max":276.671,"pressure":1023.98,"sea_level":1027.46,"grnd_level":1023.98,"humidity":100,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02n"}],"clouds":{"all":20},"wind":{"speed":5.21,"deg":286.001},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-13 09:00:00"},{"dt":1481630400,"main":{"temp":275.671,"temp_min":275.671,"temp_max":275.671,"pressure":1027.19,"sea_level":1030.68,"grnd_level":1027.19,"humidity":100,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":32},"wind":{"speed":4.56,"deg":300.501},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-13 12:00:00"},{"dt":1481641200,"main":{"temp":276.602,"temp_min":276.602,"temp_max":276.602,"pressure":1030.33,"sea_level":1033.81,"grnd_level":1030.33,"humidity":100,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":3.69,"deg":301.007},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-13 15:00:00"},{"dt":1481652000,"main":{"temp":278.052,"temp_min":278.052,"temp_max":278.052,"pressure":1030.58,"sea_level":1034.09,"grnd_level":1030.58,"humidity":100,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.52,"deg":301.004},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-13 18:00:00"},{"dt":1481662800,"main":{"temp":276.461,"temp_min":276.461,"temp_max":276.461,"pressure":1032.07,"sea_level":1035.69,"grnd_level":1032.07,"humidity":100,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.61,"deg":269.503},"rain":{},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-13 21:00:00"},{"dt":1481673600,"main":{"temp":272.581,"temp_min":272.581,"temp_max":272.581,"pressure":1033.45,"sea_level":1037.08,"grnd_level":1033.45,"humidity":100,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.34,"deg":232.501},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-14 00:00:00"},{"dt":1481684400,"main":{"temp":271.529,"temp_min":271.529,"temp_max":271.529,"pressure":1033.14,"sea_level":1036.87,"grnd_level":1033.14,"humidity":100,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04n"}],"clouds":{"all":68},"wind":{"speed":1.36,"deg":150.5},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-14 03:00:00"},{"dt":1481695200,"main":{"temp":273.982,"temp_min":273.982,"temp_max":273.982,"pressure":1032.86,"sea_level":1036.56,"grnd_level":1032.86,"humidity":100,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":92},"wind":{"speed":1.86,"deg":155},"rain":{},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-14 06:00:00"},{"dt":1481706000,"main":{"temp":275.84,"temp_min":275.84,"temp_max":275.84,"pressure":1030.62,"sea_level":1034.23,"grnd_level":1030.62,"humidity":100,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":92},"wind":{"speed":2.94,"deg":123.006},"rain":{"3h":0.06},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-14 09:00:00"},{"dt":1481716800,"main":{"temp":276.716,"temp_min":276.716,"temp_max":276.716,"pressure":1029.64,"sea_level":1033.2,"grnd_level":1029.64,"humidity":100,"temp_kf":0},"weather":[{"id":501,"main":"Rain","description":"moderate rain","icon":"10n"}],"clouds":{"all":92},"wind":{"speed":3.06,"deg":95.0023},"rain":{"3h":3.1775},"snow":{},"sys":{"pod":"n"},"dt_txt":"2016-12-14 12:00:00"},{"dt":1481727600,"main":{"temp":277.958,"temp_min":277.958,"temp_max":277.958,"pressure":1026.89,"sea_level":1030.31,"grnd_level":1026.89,"humidity":100,"temp_kf":0},"weather":[{"id":501,"main":"Rain","description":"moderate rain","icon":"10d"}],"clouds":{"all":92},"wind":{"speed":3.42,"deg":88.0005},"rain":{"3h":5.1125},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-14 15:00:00"},{"dt":1481738400,"main":{"temp":278.809,"temp_min":278.809,"temp_max":278.809,"pressure":1022.47,"sea_level":1026.01,"grnd_level":1022.47,"humidity":100,"temp_kf":0},"weather":[{"id":501,"main":"Rain","description":"moderate rain","icon":"10d"}],"clouds":{"all":92},"wind":{"speed":3.76,"deg":43.5004},"rain":{"3h":3.4125},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-14 18:00:00"},{"dt":1481749200,"main":{"temp":278.215,"temp_min":278.215,"temp_max":278.215,"pressure":1020.72,"sea_level":1024.17,"grnd_level":1020.72,"humidity":100,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":92},"wind":{"speed":4.38,"deg":44.0011},"rain":{"3h":0.8125},"snow":{},"sys":{"pod":"d"},"dt_txt":"2016-12-14 21:00:00"}]}]
  //['POST', '/bar', 200],
  //['PUT',  '/baz', 200]
];


if(mock){
    // Match ALL requests
    mock.onAny().reply(config => {
        debugger;
    const [method, url, ...response] = mockResponses.shift();
    if (config.url.indexOf(url) !== -1 && config.method.toUpperCase() === method) return response;
    // Unexpected request, error out
    return [500, {}];
    });
}

mock.restore();

export function fetchWeather(cityName){
    const url = `${ROOT_URL}&q=${cityName},us`;
    const request = axios.get(url);
    return{
        type: FETCH_WEATHER,
        payload: request
    };
}